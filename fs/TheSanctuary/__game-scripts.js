var LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseLookSensitivity",{type:"number",default:0,title:"Mouse Look Sensitivity",description:""}),LookCamera.attributes.add("touchLookSensitivity",{type:"number",default:0,title:"Touch Look Sensitivity",description:""}),LookCamera.attributes.add("sphere",{type:"entity",title:"Sphere"}),LookCamera.attributes.add("bottle",{type:"entity",title:"Bottle"}),LookCamera.prototype.initialize=function(){var t=this.entity.getLocalRotation();this.ex=this.getPitch(t)*pc.math.RAD_TO_DEG,this.ey=this.getYaw(t)*pc.math.RAD_TO_DEG,this.targetEx=this.ex,this.targetEy=this.ey,this.moved=!1,this.lmbDown=!1,this.externalControl=!1;var o=this.bottle.getLocalRotation();this.selItemEx=this.getPitch(o)*pc.math.RAD_TO_DEG,this.selItemEy=this.getYaw(o)*pc.math.RAD_TO_DEG,this.targetSelItemEx=this.selItemEx,this.targetSelItemEy=this.selItemEy,this.app.mouse.disableContextMenu(),this.lastTouchPosition=new pc.Vec2,this.addEventCallbacks(),this.app.on("lookCamera:focusModeOn",(function(){this.externalControl=!0}),this),this.app.on("lookCamera:focusModeOff",(function(){this.externalControl=!1}),this),this.app.on("lookCamera:rotateleft",(function(){var t=-15;!pc.platform.mobile&&this.app.xr.active&&(t=-30),this.targetSelItemEy+=t*this.mouseLookSensitivity}),this),this.app.on("lookCamera:rotateright",(function(){var t=15;!pc.platform.mobile&&this.app.xr.active&&(t=30),this.targetSelItemEy+=t*this.mouseLookSensitivity}),this),this.on("destroy",(function(){this.removeEventCallbacks()})),this.app.xr.on("start",(function(){this.entity.setLocalEulerAngles(0,0,0)}),this)},LookCamera.prototype.addEventCallbacks=function(){this.app.mouse&&(this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this)),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this))},LookCamera.prototype.removeEventCallbacks=function(){this.app.mouse&&(this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this)),this.app.touch&&(this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this))},LookCamera.prototype.getYaw=function(t){var o=t,e=o.x*o.x,i=o.y*o.y;return Math.atan2(2*o.y*o.w-2*o.z*o.x,1-2*i-2*e)},LookCamera.prototype.getPitch=function(t){var o=t;return-Math.asin(2*o.z*o.y+2*o.x*o.w)},LookCamera.prototype.update=function(t){this.selItemEx=pc.math.lerp(this.selItemEx,this.targetSelItemEx,t/.2),this.selItemEy=pc.math.lerp(this.selItemEy,this.targetSelItemEy,t/.2),this.bottle&&this.bottle.setLocalEulerAngles(this.selItemEx,this.selItemEy,0),this.ex=pc.math.lerp(this.ex,this.targetEx,t/.2),this.ey=pc.math.lerp(this.ey,this.targetEy,t/.2),this.app.xr.active||this.entity.setLocalEulerAngles(this.ex,this.ey,0),this.sphere.setPosition(this.entity.getPosition())},LookCamera.prototype.moveCamera=function(t,o,e){this.moved?this.externalControl?(this.targetSelItemEx+=o*e,this.targetSelItemEx=pc.math.clamp(this.targetSelItemEx,-90,90),this.targetSelItemEy+=t*e):(this.targetEx+=o*e,this.targetEx=pc.math.clamp(this.targetEx,-90,90),this.targetEy+=t*e):this.moved=!0},LookCamera.prototype.onMouseMove=function(t){this.lmbDown&&this.moveCamera(t.dx,t.dy,this.mouseLookSensitivity)},LookCamera.prototype.onMouseDown=function(t){0===t.button&&(this.lmbDown=!0)},LookCamera.prototype.onMouseUp=function(t){0===t.button&&(this.lmbDown=!1)},LookCamera.prototype.onTouchStart=function(t){if(1==t.touches.length){this.lmbDown=!0;var o=t.touches[0];this.lastTouchPosition.set(o.x,o.y);var e=this.onSelect(o.x,o.y);e&&e===this.bottle&&(this.externalControl=!0)}t.event.preventDefault()},LookCamera.prototype.onTouchEnd=function(t){if(0===t.touches.length)this.lmbDown=!1,this.externalControl=!1;else if(1==t.touches.length){var o=t.touches[0];this.lastTouchPosition.set(o.x,o.y)}},LookCamera.prototype.onTouchMove=function(t){var o=t.touches[0];1==t.touches.length&&this.moveCamera(o.x-this.lastTouchPosition.x,o.y-this.lastTouchPosition.y,this.touchLookSensitivity),this.lastTouchPosition.set(o.x,o.y)},LookCamera.prototype.onTouchCancel=function(t){this.externalControl=!1,this.lmbDown=!1},LookCamera.prototype.onSelect=function(t,o){var e=this.app,i=this.entity.camera.screenToWorld(t,o,this.entity.camera.nearClip),s=this.entity.camera.screenToWorld(t,o,this.entity.camera.farClip),h=e.systems.rigidbody.raycastFirst(i,s),a=null;return h&&(a=h.entity),a};var Vr=pc.createScript("vr");Vr.attributes.add("vrButton",{type:"entity"}),Vr.attributes.add("cameraEntity",{type:"entity"}),Vr.attributes.add("helperPointer",{type:"entity"}),Vr.attributes.add("gazingTime",{type:"number",default:1,description:"Time before selection when gazing"}),Vr.attributes.add("mouseHelper",{type:"boolean",default:!1}),Vr.attributes.add("touchHelper",{type:"boolean",default:!1}),Vr.prototype.initialize=function(){var t=this.app;this.selectedEntity=null,this.worldPos=new pc.Vec3,this.isAction=!1,this.isDragging=!1,this.timer=0,this.pointerScale=this.helperPointer.getLocalScale().clone(),t.mouse&&(t.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),t.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),t.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),t.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)),t.touch&&(t.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),t.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),t.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.vrButton.enabled=t.xr.supported&&t.xr.isAvailable(pc.XRTYPE_VR),this.vrButton.element.on("click",(function(){this.vrButton.script.pulse.pulse(),this.app.xr.isAvailable(pc.XRTYPE_VR)&&(window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){"granted"==t&&window.addEventListener("deviceorientation",function(t){this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCAL)}.bind(this))}.bind(this)).catch(console.error):this.cameraEntity.camera.startXr(pc.XRTYPE_VR,pc.XRSPACE_LOCAL))}),this),t.keyboard.on("keydown",(function(e){e.key===pc.KEY_ESCAPE&&t.xr.active&&t.xr.end()}),this),t.xr.on("start",(function(){for(var e=t.root.findByTag("HideInVR"),i=0;i<e.length;++i)e[i].enabled=!1;t.mouse&&(t.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),t.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),t.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),t.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)),t.touch&&(pc.platform.mobile&&this.helperPointerEnabled(!0),t.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),t.touch.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),t.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.vrButton.enabled=!1}),this),t.xr.on("end",(function(){for(var e=t.root.findByTag("HideInVR"),i=0;i<e.length;++i)e[i].enabled=!0;this.cameraEntity.setPosition(0,0,0),t.mouse&&(t.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),t.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),t.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),t.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)),t.touch&&(pc.platform.mobile&&this.helperPointerEnabled(!1),t.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),t.touch.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),t.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.vrButton.enabled=!0}),this)},Vr.prototype.helperPointerEnabled=function(t){this.helperPointer.enabled=t},Vr.prototype.onTouchStart=function(t){this.isAction=!0},Vr.prototype.onTouchEnd=function(t){var e=this.app,i=this;if(this.isAction=!1,!e.xr.active)if(this.isDragging)this.isDragging=!1;else if(0!==t.changedTouches.length){var o=t.changedTouches[0];!this.onSelect(o.x,o.y)&&this.touchHelper&&(this.helperPointerEnabled(!0),this.setHelperPointer(o.x,o.y,this.cameraEntity),this.helperPointer.script.pulse.pulse(),setTimeout((function(){i.helperPointerEnabled(!1)}),300)),t.event.preventDefault()}},Vr.prototype.setHelperPointer=function(t,e,i){var o=i.getPosition(),n=this.worldPos;i.camera.screenToWorld(t,e,o.z+2,n),this.helperPointer.setLocalPosition(n),this.helperPointer.setRotation(i.getRotation()),this.helperPointer.rotateLocal(90,0,0)},Vr.prototype.onTouchMove=function(t){this.isAction&&(this.isDragging=!0)},Vr.prototype.onMouseDown=function(t){this.isAction=!0},Vr.prototype.onMouseUp=function(t){var e=this.app,i=this;(this.isAction=!1,this.isDragging)?this.isDragging=!1:(e.fire("interactMgr:hoveroff",this.selectedEntity),this.selectedEntity=null,!this.onSelect(t.x,t.y)&&this.mouseHelper&&(this.helperPointerEnabled(!0),this.setHelperPointer(t.x,t.y,this.cameraEntity),this.helperPointer.script.pulse.pulse(),setTimeout((function(){i.helperPointerEnabled(!1)}),300)))},Vr.prototype.onMouseMove=function(t){if(this.isAction)this.isDragging=!0;else{var e=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),i=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip);this.doRaycast(e,i,0,!1)}},Vr.prototype.onMouseWheel=function(t){t&&t.event&&t.event.preventDefault()},Vr.prototype.onSelect=function(t,e){var i=this.app,o=this.cameraEntity.camera.screenToWorld(t,e,this.cameraEntity.camera.nearClip),n=this.cameraEntity.camera.screenToWorld(t,e,this.cameraEntity.camera.farClip),r=i.systems.rigidbody.raycastFirst(o,n);if(r){var s=r.entity;i.fire("interactMgr:activate",s)}return!(null==r)},Vr.prototype.doRaycast=function(t,e,i,o){var n=this.app,r=this,s=n.systems.rigidbody.raycastFirst(t,e);if(s){var a=s.entity;if(a!==r.selectedEntity)n.fire("interactMgr:hoveroff",r.selectedEntity),n.fire("interactMgr:hoveron",a),r.selectedEntity=a,o&&(this.timer=0,this.helperPointer.setLocalScale(this.pointerScale));else if(o)if(this.timer+=i,this.timer>this.gazingTime)n.fire("interactMgr:activate",a),a.tags.has("repeatable")||(this.timer=0);else{var h=this.helperPointer.getScale();h.x-=.006,h.y-=.006,h.z-=.006,this.helperPointer.setLocalScale(h)}}else r.selectedEntity&&(n.fire("interactMgr:hoveroff",r.selectedEntity),r.selectedEntity=null,o&&(this.timer=0,this.helperPointer.setLocalScale(this.pointerScale)))},Vr.prototype.update=function(t){var e=this.app;if(pc.platform.mobile&&e.xr.active){var i=e.graphicsDevice.width/2,o=e.graphicsDevice.height/2;this.helperPointerEnabled(!0),this.setHelperPointer(i,o,this.cameraEntity);var n=this.cameraEntity.camera.screenToWorld(i,o,this.cameraEntity.camera.nearClip),r=this.cameraEntity.camera.screenToWorld(i,o,this.cameraEntity.camera.farClip);this.doRaycast(n,r,t,!0)}};var FadeOut=pc.createScript("fadeOut");FadeOut.attributes.add("event",{type:"string"}),FadeOut.attributes.add("duration",{type:"number",default:1e3}),FadeOut.prototype.initialize=function(){this.app.on(this.event,(function(){var t=this.entity.sprite;t.opacity=1;var e=this.duration;new TWEEN.Tween(t).to({opacity:0},e).onStart((function(){t.enabled=!0})).onComplete((function(){t.enabled=!1})).repeat(0).yoyo(!1).start()}),this),this.on("enable",(function(){var t=this.entity.sprite;t.enabled=!0,t.opacity=1}))};var Fade=pc.createScript("fade");Fade.attributes.add("event",{type:"string"}),Fade.attributes.add("type",{type:"number",enum:[{In:0},{Out:1},{InOut:2}]}),Fade.attributes.add("duration",{type:"number",default:1e3}),Fade.attributes.add("delay",{type:"number",default:0}),Fade.prototype.initialize=function(){this.app.on(this.event,(function(){var t=this.type,e=this.entity.sprite;e.opacity=1===t?1:0;var a=this.duration;2===t&&(a*=.5);new TWEEN.Tween(e).to({opacity:1===t?0:1},a).onStart((function(){e.enabled=!0})).onComplete((function(){e.enabled=0===t})).repeat(2===t?1:0).yoyo(2===t).delay(this.delay).start()}),this),this.on("enable",(function(){var t=this.type,e=this.entity.sprite;e.enabled=1===t,e.opacity=1===t?1:0}))};var FadeIn=pc.createScript("fadeIn");FadeIn.attributes.add("event",{type:"string"}),FadeIn.attributes.add("duration",{type:"number",default:1e3}),FadeIn.prototype.initialize=function(){this.app.on(this.event,(function(){var t=this.entity.sprite;t.opacity=0;var e=this.duration;new TWEEN.Tween(t).to({opacity:1},e).onStart((function(){t.enabled=!0})).onComplete((function(){t.enabled=!0})).repeat(0).yoyo(!1).start()}),this),this.on("enable",(function(){var t=this.entity.sprite;t.enabled=!1,t.opacity=0}))};var Button=pc.createScript("button");Button.attributes.add("sound",{type:"string"}),Button.attributes.add("event",{type:"string"}),Button.attributes.add("copyEnabled",{type:"boolean",default:!1}),Button.attributes.add("entityToCopyText",{type:"entity",title:"Entity to copy text"}),Button.attributes.add("eventCopy",{type:"string",default:"game:copycoupon"}),Button.attributes.add("switchEnabled",{type:"boolean",default:!1}),Button.attributes.add("stringidstart",{type:"string"}),Button.attributes.add("stringidfinish",{type:"string"}),Button.attributes.add("switchMessageTime",{type:"number",default:2e3}),Button.prototype.initialize=function(){this.app;this.pressed=!1,this.entity.element.on("click",this.onClick,this)},Button.prototype.onClick=function(t){var e=this.app;if((!this.entity.button||this.entity.button.active)&&(this.entity.script.pulse&&this.entity.script.pulse.pulse(),e.fire(this.event),e.fire("game:playSound",this.sound),this.copyEnabled&&e.fire(this.eventCopy,this.entityToCopyText.element.text),this.switchEnabled)){var i=this;this.entity.element&&this.entity.element.text?(this.entity.element.text=e.i18n.getText(this.stringidfinish),setTimeout((function(){i.entity.element.text=e.i18n.getText(i.stringidstart)}),this.switchMessageTime)):this.entity.children.length>0&&this.entity.children[0]&&this.entity.children[0].element&&this.entity.children[0].element.text&&(this.entity.children[0].element.text=e.i18n.getText(this.stringidfinish),setTimeout((function(){i.entity.children[0].element.text=e.i18n.getText(i.stringidstart)}),this.switchMessageTime))}};var Pulse=pc.createScript("pulse");Pulse.attributes.add("startingEvent",{title:"Event",type:"string"}),Pulse.attributes.add("loop",{title:"Loop",type:"boolean",default:!1}),Pulse.attributes.add("duration",{type:"number",default:.1,description:"Tween animation duration"}),Pulse.attributes.add("scaleincrement",{type:"number",default:1,description:"Amout of scaling on pulse animation"}),Pulse.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(){this.pulse()}),this)},Pulse.prototype.pulse=function(){var t=this;if(!this.isRunning){this.isRunning=!0;var e=this.entity.getLocalScale().clone(),i=this.entity.tween(this.entity.getLocalScale()).to({x:e.x+this.scaleincrement,y:e.y+this.scaleincrement,z:e.z+this.scaleincrement},this.duration,pc.SineInOut);this.loop?i.loop(!0).yoyo(!0):i.yoyo(!0).repeat(2).on("complete",(function(){t.isRunning=!1})),i.start()}};var GameManager=pc.createScript("gameManager");GameManager.attributes.add("Entry",{type:"entity"}),GameManager.attributes.add("Training",{type:"entity"}),GameManager.attributes.add("Tattoo",{type:"entity"}),GameManager.attributes.add("Lounge",{type:"entity"}),GameManager.attributes.add("Board",{type:"entity"}),GameManager.attributes.add("timeTutoIsShown",{type:"number",default:2}),GameManager.attributes.add("formUrl",{type:"string"}),GameManager.attributes.add("cameraEntity",{type:"entity"}),GameManager.prototype.initialize=function(){var e=this.app;e.addTweenManager(),e.fire("game:playSound","Music"),this.viewMode="Landscape",this.boardStartingPos=this.Board.getPosition().clone(),this.UpdateVisuals("Landscape"===this.viewMode),this.currentIndex=0,e.on("game:landscape",(function(){"Landscape"!==this.viewMode&&(this.viewMode="Landscape",this.UpdateVisuals("Landscape"===this.viewMode))}),this),e.on("game:portrait",(function(){"Portrait"!==this.viewMode&&(this.viewMode="Portrait",this.UpdateVisuals("Landscape"===this.viewMode))}),this),e.keyboard.on("keydown",(function(e){}),this),e.on("game:activate",(function(t){var a=-1;switch(t.name){case"GenTeleportZone":a=0;break;case"TattooTeleportZone":a=1;break;case"LoungeTeleportZone":a=2;break;case"TrainingTeleportZone":a=3}if(t.tags.has("url")?(e.fire("bottlemgr:hideBtnClick",!1),t.script.launchUrl.launch()):t.tags.has("closeboard")?e.fire("infoboard:close"):t.tags.has("openweb")&&e.fire("infoboard:openlink"),-1!==a){if(this.currentIndex===a)return;e.fire("infoboard:close"),this.currentIndex=a,e.fire("game:switchview",a,t.getPosition())}}),this),e.on("game:switchview",(function(t,a){var i=this,n=new pc.Vec3;n.sub2(a,this.cameraEntity.getPosition()),n.y=0,n.normalize(),i.Entry.enabled=!1,i.Training.enabled=!1,i.Tattoo.enabled=!1,i.Lounge.enabled=!1,e.fire("tv:fadeout"),e.fire("flash:blackIn"),e.fire("sphere:startAnim",n.clone().scale(-1)),e.fire("media-player:muteVideo",!1),this.entity.script.bottleManager.hideBottle(!1),setTimeout((function(){e.fire("switch:toindex",t),e.fire("sphere:endAnim",n),e.fire("flash:blackOut"),setTimeout((function(){switch(t){case 0:i.Entry.enabled=!0,i.Training.enabled=!1,i.Tattoo.enabled=!1,i.Lounge.enabled=!1,e.fire("entry:enabled"),e.fire("tv:fadein"),e.fire("reparentboard:update");break;case 1:i.Tattoo.enabled=!0,i.Entry.enabled=!1,i.Training.enabled=!1,i.Lounge.enabled=!1,e.fire("pulse:start"),e.fire("tattoo:enabled"),e.fire("tv:fadein"),e.fire("reparentboard:update");break;case 2:i.Lounge.enabled=!0,i.Entry.enabled=!1,i.Training.enabled=!1,i.Tattoo.enabled=!1,e.fire("pulse:start"),e.fire("lounge:enabled"),e.fire("tv:fadein"),e.fire("reparentboard:update");break;case 3:i.Training.enabled=!0,i.Entry.enabled=!1,i.Tattoo.enabled=!1,i.Lounge.enabled=!1,e.fire("pulse:start"),e.fire("training:enabled"),e.fire("tv:fadein"),e.fire("reparentboard:update")}}),750)}),500)}),this),e.on("game:openform",(function(){var e=screen.width/2-320,t=screen.height/2-190;window.open(this.formUrl,"popup","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=640, height=380, top="+t+", left="+e)}),this),e.on("game:playSound",(function(e){this.entity.sound.play(e)}),this),e.on("game:stopSound",(function(e){this.entity.sound.stop(e)}),this),e.on("game:muteAll",(function(){}),this)},GameManager.prototype.UpdateVisuals=function(e){this.app;e?this.Board.setLocalPosition(this.boardStartingPos.x,this.boardStartingPos.y,this.boardStartingPos.z):this.Board.setLocalPosition(this.boardStartingPos.x,this.boardStartingPos.y,this.boardStartingPos.z-1)},GameManager.prototype.postInitialize=function(){var e=this.app;e.fire("media-player:playBtnClick",!1,!0),setTimeout((function(){e.fire("tuto:fadeout")}),this.timeTutoIsShown)},GameManager.prototype.update=function(e){TWEEN.update()};var _Group=function(){this._tweens={},this._tweensAddedDuringUpdate={}};_Group.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,n){var e=Object.keys(this._tweens);if(0===e.length)return!1;for(t=void 0!==t?t:TWEEN.now();e.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<e.length;i++){var r=this._tweens[e[i]];r&&!1===r.update(t)&&(r._isPlaying=!1,n||delete this._tweens[e[i]])}e=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var TWEEN=new _Group;TWEEN.Group=_Group,TWEEN._nextId=0,TWEEN.nextId=function(){return TWEEN._nextId++},"undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?TWEEN.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?TWEEN.now=self.performance.now.bind(self.performance):void 0!==Date.now?TWEEN.now=Date.now:TWEEN.now=function(){return(new Date).getTime()},TWEEN.Tween=function(t,n){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=TWEEN.Easing.Linear.None,this._interpolationFunction=TWEEN.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=n||TWEEN,this._id=TWEEN.nextId()},TWEEN.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,n){return this._valuesEnd=Object.create(t),void 0!==n&&(this._duration=n),this},duration:function duration(t){return this._duration=t,this},start:function(t){for(var n in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?TWEEN.now()+parseFloat(t):t:TWEEN.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[n]instanceof Array){if(0===this._valuesEnd[n].length)continue;this._valuesEnd[n]=[this._object[n]].concat(this._valuesEnd[n])}void 0!==this._object[n]&&(this._valuesStart[n]=this._object[n],this._valuesStart[n]instanceof Array==!1&&(this._valuesStart[n]*=1),this._valuesStartRepeat[n]=this._valuesStart[n]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function onRepeat(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var n,e,i;if(t<this._startTime)return!0;for(n in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),e=(t-this._startTime)/this._duration,e=0===this._duration||e>1?1:e,i=this._easingFunction(e),this._valuesEnd)if(void 0!==this._valuesStart[n]){var r=this._valuesStart[n]||0,a=this._valuesEnd[n];a instanceof Array?this._object[n]=this._interpolationFunction(a,i):("string"==typeof a&&(a="+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),"number"==typeof a&&(this._object[n]=r+(a-r)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,e),1===e){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[n]&&(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo){var s=this._valuesStartRepeat[n];this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=s}this._valuesStart[n]=this._valuesStartRepeat[n]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,u=this._chainedTweens.length;o<u;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}return!0}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var n=1.70158;return t*t*((n+1)*t-n)},Out:function(t){var n=1.70158;return--t*t*((n+1)*t+n)+1},InOut:function(t){var n=2.5949095;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=TWEEN.Interpolation.Utils.Linear;return n<0?a(t[0],t[1],i):n>1?a(t[e],t[e-1],e-i):a(t[r],t[r+1>e?e:r+1],i-r)},Bezier:function(t,n){for(var e=0,i=t.length-1,r=Math.pow,a=TWEEN.Interpolation.Utils.Bernstein,s=0;s<=i;s++)e+=r(1-n,i-s)*r(n,s)*t[s]*a(i,s);return e},CatmullRom:function(t,n){var e=t.length-1,i=e*n,r=Math.floor(i),a=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[e]?(n<0&&(r=Math.floor(i=e*(1+n))),a(t[(r-1+e)%e],t[r],t[(r+1)%e],t[(r+2)%e],i-r)):n<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):n>1?t[e]-(a(t[e],t[e],t[e-1],t[e-1],i-e)-t[e]):a(t[r?r-1:0],t[r],t[e<r+1?e:r+1],t[e<r+2?e:r+2],i-r)},Utils:{Linear:function(t,n,e){return(n-t)*e+t},Bernstein:function(t,n){var e=TWEEN.Interpolation.Utils.Factorial;return e(t)/e(n)/e(t-n)},Factorial:function(){var t=[1];return function(n){var e=1;if(t[n])return t[n];for(var i=n;i>1;i--)e*=i;return t[n]=e,e}}(),CatmullRom:function(t,n,e,i,r){var a=.5*(e-t),s=.5*(i-n),o=r*r;return(2*n-2*e+a+s)*(r*o)+(-3*n+3*e-2*a-s)*o+a*r+n}}},function(t){"function"==typeof define&&define.amd?define([],(function(){return TWEEN})):"undefined"!=typeof module&&"object"==typeof exports?module.exports=TWEEN:void 0!==t&&(t.TWEEN=TWEEN)}(this);pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();var Tweener=pc.createScript("tweener");Tweener.attributes.add("event",{title:"Event",type:"string"}),Tweener.attributes.add("duration",{title:"Duration",type:"number",default:1e3}),Tweener.attributes.add("easingFunction",{title:"Easing Function",type:"number",enum:[{Linear:0},{Quadratic:1},{Cubic:2},{Quartic:3},{Quintic:4},{Sinusoidal:5},{Exponential:6},{Circular:7},{Elastic:8},{Back:9},{Bounce:10}]}),Tweener.attributes.add("easingType",{title:"Easing Type",type:"number",enum:[{In:0},{Out:1},{InOut:2}]}),Tweener.attributes.add("delay",{title:"Delay",type:"number",default:0}),Tweener.attributes.add("repeat",{title:"Repeat",type:"number",default:0}),Tweener.attributes.add("repeatDelay",{title:"Repeat Delay",type:"number",default:0}),Tweener.attributes.add("yoyo",{title:"Yoyo",type:"boolean",default:!1}),Tweener.attributes.add("startPos",{title:"Start Pos",type:"vec3",default:[0,0,0]}),Tweener.attributes.add("endPos",{title:"End Pos",type:"vec3",default:[0,0,0]}),Tweener.attributes.add("startRot",{title:"Start Rot",type:"vec3",default:[0,0,0]}),Tweener.attributes.add("endRot",{title:"End Rot",type:"vec3",default:[0,0,0]}),Tweener.attributes.add("startScale",{title:"Start Scale",type:"vec3",default:[1,1,1]}),Tweener.attributes.add("endScale",{title:"End Scale",type:"vec3",default:[1,1,1]}),Tweener.attributes.add("startEvent",{title:"Start Event",type:"string"}),Tweener.attributes.add("stopEvent",{title:"Stop Event",type:"string"}),Tweener.attributes.add("updateEvent",{title:"Update Event",type:"string"}),Tweener.attributes.add("completeEvent",{title:"Complete Event",type:"string"}),Tweener.attributes.add("repeatEvent",{title:"Repeat Event",type:"string"}),Tweener.prototype.initialize=function(){var t=this.app;this.initialPos=this.entity.getPosition().clone(),this.initialScl=this.entity.getLocalScale().clone(),this.initialRot=this.entity.getLocalEulerAngles().clone(),this.tween=null,t.on(this.event,(function(){this.start()}),this),this.on("enable",(function(){this.entity.setPosition(this.initialPos),this.entity.setLocalScale(this.initialScl),this.entity.setLocalEulerAngles(this.initialRot)})),this.on("attr",(function(t,e,i){this.start()}))},Tweener.prototype.start=function(){var t,e=this.app,i=["Linear","Quadratic","Cubic","Quartic","Quintic","Sinusoidal","Exponential","Circular","Elastic","Back","Bounce"];t=0===this.easingFunction?TWEEN.Easing[i[this.easingFunction]].None:TWEEN.Easing[i[this.easingFunction]][["In","Out","InOut"][this.easingType]],this.tween&&this.tween.stop();var n={px:this.startPos.x,py:this.startPos.y,pz:this.startPos.z,sx:this.startScale.x,sy:this.startScale.y,sz:this.startScale.z,rx:this.startRot.x,ry:this.startRot.y,rz:this.startRot.z},a={px:this.endPos.x,py:this.endPos.y,pz:this.endPos.z,sx:this.endScale.x,sy:this.endScale.y,sz:this.endScale.z,rx:this.endRot.x,ry:this.endRot.y,rz:this.endRot.z},s=this.entity;this.tween=new TWEEN.Tween(n).to(a,this.duration).easing(t).onStart(function(t){""!==this.startEvent&&e.fire(this.startEvent)}.bind(this)).onStop(function(t){""!==this.stopEvent&&e.fire(this.stopEvent)}.bind(this)).onUpdate(function(t){s.setPosition(t.px,t.py,t.pz),s.setLocalScale(t.sx,t.sy,t.sz),s.setEulerAngles(t.rx,t.ry,t.rz),""!==this.updateEvent&&e.fire(this.updateEvent)}.bind(this)).onComplete(function(t){""!==this.completeEvent&&e.fire(this.completeEvent)}.bind(this)).onRepeat(function(t){""!==this.repeatEvent&&e.fire(this.repeatEvent)}.bind(this)).repeat(this.repeat).repeatDelay(this.repeatDelay).yoyo(this.yoyo).delay(this.delay).start()};var SwitchingMaterials=pc.createScript("switchingMaterials");SwitchingMaterials.attributes.add("materials",{type:"asset",assetType:"material",array:!0,title:"Materials"}),SwitchingMaterials.prototype.initialize=function(){var t=this.app;this.materialIndex=0,t.on("switch:toindex",(function(t){this.changeMaterial(t)}),this),t.on("switch:general",(function(){this.changeMaterial(0)}),this),t.on("switch:lounge",(function(){this.changeMaterial(1)}),this),t.on("switch:tattoo",(function(){this.changeMaterial(2)}),this),t.on("switch:training",(function(){this.changeMaterial(3)}),this)},SwitchingMaterials.prototype.changeMaterial=function(t){if(t<this.materials.length&&t>=0){this.materialIndex=t;for(var i=this.materials[this.materialIndex],a=this.entity.model.meshInstances,e=0;e<a.length;++e){a[e].material=i.resource}}},SwitchingMaterials.prototype.changeToNextMaterial=function(){this.materialIndex=(this.materialIndex+1)%this.materials.length;for(var t=this.materials[this.materialIndex],i=this.entity.model.meshInstances,a=0;a<i.length;++a){i[a].material=t.resource}};var XrInputManager=pc.createScript("xrInputManager");XrInputManager.attributes.add("controllerTemplate",{type:"entity"}),XrInputManager.attributes.add("cameraParent",{type:"entity"}),XrInputManager.prototype.initialize=function(){this.app.xr.input.on("add",this.onAdd,this)},XrInputManager.prototype.onAdd=function(t){var e=this.controllerTemplate.clone();e.script.controller.setInputSource(t),e.reparent(this.cameraParent),e.enabled=!0};var Controller=pc.createScript("controller");Controller.prototype.initialize=function(){this.vecA=new pc.Vec3,this.vecB=new pc.Vec3,this.matA=new pc.Mat4,this.quat=new pc.Quat,this.color=new pc.Color(1,1,1),this.isAction=!1,this.selectedEntity=null},Controller.prototype.setInputSource=function(t){this.inputSource=t,this.inputSource.once("remove",this.onRemove,this)},Controller.prototype.onRemove=function(){this.entity.destroy()},Controller.prototype.update=function(t){if(this.vecA.copy(this.inputSource.getOrigin()),this.vecB.copy(this.inputSource.getDirection()),this.vecB.scale(1e3).add(this.vecA),this.inputSource.selecting)this.color.set(0,1,0),this.isAction=!0;else{if(this.color.set(1,1,1),this.isAction&&this.selectedEntity)return this.app.fire("interactMgr:hoveroff",this.selectedEntity),this.app.fire("interactMgr:activate",this.selectedEntity),this.selectedEntity=null,void(this.isAction=!1);this.isAction=!1}this.app.renderLine(this.vecA,this.vecB,this.color),this.onMove(this.vecA,this.vecB),this.inputSource.grip?(this.entity.model.enabled=!0,this.entity.setPosition(this.inputSource.getPosition()),this.entity.setRotation(this.inputSource.getRotation())):(this.entity.model.enabled=!1,this.entity.setLocalPosition(0,0,0),this.vecA.set(0,0,0),this.vecB.set(0,1,0),this.matA.setLookAt(this.vecA,this.inputSource.getDirection(),this.vecB),this.quat.setFromMat4(this.matA),this.entity.setRotation(this.quat))},Controller.prototype.onMove=function(t,e){var i=this.app,s=this,o=i.systems.rigidbody.raycastFirst(t,e);if(o){var n=o.entity;n!==s.selectedEntity&&(i.fire("interactMgr:hoveroff",s.selectedEntity),i.fire("interactMgr:hoveron",n),s.selectedEntity=n)}else s.selectedEntity&&(i.fire("interactMgr:hoveroff",s.selectedEntity),s.selectedEntity=null)};var Circle=pc.createScript("circle");Circle.attributes.add("InnerRadius",{type:"number",default:.05}),Circle.attributes.add("OuterRadius",{type:"number",default:.45}),Circle.attributes.add("Thickness",{type:"number",default:.025}),Circle.attributes.add("Speed",{type:"number",default:.001}),Circle.attributes.add("Animated",{type:"boolean",default:!0}),Circle.prototype.initialize=function(){this.UpdateMaterial(this.entity.model.material),this.entity.model.meshInstances[0].setParameter("circle_radius",this.OuterRadius),this.entity.model.meshInstances[0].setParameter("circle_thickness",this.Thickness)},Circle.prototype.GetRandomInt=function(e,i){return e=Math.ceil(e),i=Math.floor(i),Math.floor(Math.random()*(i-e))+e},Circle.prototype.UpdateMaterial=function(e){e.chunks.emissivePS=["#ifdef MAPCOLOR","uniform vec3 material_emissive;","#endif","","#ifdef MAPFLOAT","uniform float material_emissiveIntensity;","#endif","","#ifdef MAPTEXTURE","uniform sampler2D texture_emissiveMap;","uniform float circle_radius;","uniform float circle_thickness;","#endif","","vec3 getEmission() {","    vec3 emission = vec3(1.0);","","    #ifdef MAPFLOAT","        emission *= material_emissiveIntensity;","    #endif","","    #ifdef MAPCOLOR","        emission *= material_emissive;","    #endif","","    #ifdef MAPTEXTURE","        emission *= $texture2DSAMPLE(texture_emissiveMap, $UV).$CH;","        vec2 uv = $UV.xy - vec2(0.5);","        if ((length(uv) < circle_radius - circle_thickness * 0.5) || (length(uv) > circle_radius + circle_thickness * 0.5))","        {","            discard;","        }","        else if (length(uv) > circle_radius + circle_thickness * 0.5)","        {","            emission *= 0.25;","        }","    #endif","","    #ifdef MAPVERTEX","        emission *= gammaCorrectInput(saturate(vVertexColor.$VC));","    #endif","","    return emission;","}"].join("\n"),e.update()},Circle.prototype.update=function(e){if(this.Animated){var i=.5*(Math.sin(Date.now()*this.Speed)+1),t=pc.math.lerp(this.InnerRadius,this.OuterRadius,i);this.entity.model.meshInstances[0].setParameter("circle_radius",t),this.entity.model.meshInstances[0].setParameter("circle_thickness",this.Thickness)}};var ColorEvent=pc.createScript("colorEvent");ColorEvent.attributes.add("eventName",{type:"string",title:"Event Name"}),ColorEvent.attributes.add("color",{type:"rgba",title:"Color"}),ColorEvent.prototype.initialize=function(){this.entity.button.on("click",(function(){this.app.fire(this.eventName,this.color)}),this)};var NumberEvent=pc.createScript("numberEvent");NumberEvent.attributes.add("eventName",{type:"string",title:"Event Name"}),NumberEvent.attributes.add("number",{type:"number",title:"Number"}),NumberEvent.prototype.initialize=function(){this.entity.button.on("click",(function(){this.app.fire(this.eventName,this.number)}),this)};var Event=pc.createScript("event");Event.attributes.add("eventName",{type:"string",title:"Event Name"}),Event.prototype.initialize=function(){this.entity.button.on("click",(function(){this.app.fire(this.eventName)}),this)};var MediaPlayer=pc.createScript("mediaPlayer");MediaPlayer.attributes.add("screenMaterial",{type:"asset",assetType:"material",title:"Material"}),MediaPlayer.attributes.add("url",{type:"string",title:"Url"}),MediaPlayer.attributes.add("videoToPlay",{title:"Video",description:"MP4 video asset to play back on this video texture.",type:"asset"}),MediaPlayer.attributes.add("playButton",{type:"entity"}),MediaPlayer.attributes.add("stopButton",{type:"entity"}),MediaPlayer.attributes.add("ignoreEvents",{type:"boolean",default:!1}),MediaPlayer.attributes.add("autoPlay",{type:"boolean",default:!1}),MediaPlayer.prototype.createTexture=function(){var t,e,i=this.app;return(t=new pc.Texture(i.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8,autoMipmap:!1})).minFilter=pc.FILTER_LINEAR,t.magFilter=pc.FILTER_LINEAR,t.addressU=pc.ADDRESS_CLAMP_TO_EDGE,t.addressV=pc.ADDRESS_CLAMP_TO_EDGE,this.screenMaterial&&((e=this.screenMaterial.resource).emissiveMap=t,e.update()),t},MediaPlayer.prototype.initVideo=function(t){this.video.src=t,this.play(!1,!1)},MediaPlayer.prototype.stopVideo=function(){this.stop(!1)},MediaPlayer.prototype.initialize=function(){var t=this.app;this.isVideo=!1,this.updateEvery=2,this.playing=!1,this.frameCount=0;var e=this.createTexture(),i=document.createElement("video"),o=new Image;i.muted=!0,i.playsInline=!0,this.isFromUrl=!0;var a="";this.url?a=this.url.split(".").pop():this.videoToPlay&&(a=(a=this.videoToPlay.getFileUrl().split(".").pop()).split("?").shift(),this.isFromUrl=!1),"mp4"===a||this.isFromUrl?(i.addEventListener("canplay",(function(t){e.setSource(i)})),i.src=this.isFromUrl?this.url:this.videoToPlay.getFileUrl(),i.crossOrigin="anonymous",i.loop=!0,i.preload=!0,this.isVideo=!0):(o.addEventListener("load",(function(t){e.setSource(o)})),o.crossOrigin="anonymous",o.src=this.url,this.isVideo=!1),this.texture=e,this.image=o,this.video=i,t.on("media-player:playBtnClick",(function(t,e){this.ignoreEvents||this.play(t,e)}),this),t.on("media-player:stopBtnClick",(function(t){this.ignoreEvents||this.stop(t)}),this),t.on("media-player:muteVideo",(function(t){this.ignoreEvents||this.mute(t)}),this),this.autoPlay&&this.play(!1,!0),t.fire("pulse:start")},MediaPlayer.prototype.isPlaying=function(){return this.isVideo&&this.playing},MediaPlayer.prototype.PlayButtonEnabled=function(t){this.playButton&&(this.playButton.enabled=t)},MediaPlayer.prototype.StopButtonEnabled=function(t){this.stopButton&&(this.stopButton.enabled=t)},MediaPlayer.prototype.play=function(t,e){var i=this.app,o=this;this.isVideo&&(this.playing?(console.log("restart video"),this.PlayButtonEnabled(!1),this.StopButtonEnabled(!0),t&&(pc.platform.mobile&&!i.xr.active||this.stopButton&&(this.stopButton.model.material.emissive=this.stopButton.script.hoverChangeColor.hoverColor,this.stopButton.model.material.update())),setTimeout((function(){o.playing=!0,o.video.muted=!1,o.video.load(),o.video.play(),i.fire("pulse:start"),i.fire("music:fadeOut","Music")}),250)):(console.log("play video"),e||(this.PlayButtonEnabled(!1),this.StopButtonEnabled(!0)),t&&(pc.platform.mobile&&!i.xr.active||this.stopButton&&(this.stopButton.model.material.emissive=this.stopButton.script.hoverChangeColor.hoverColor,this.stopButton.model.material.update())),setTimeout((function(){o.playing=!0,o.video.muted=e,o.video.play(),i.fire("pulse:start"),e||i.fire("music:fadeOut","Music")}),250)))},MediaPlayer.prototype.stop=function(t){var e=this.app,i=this;this.isVideo&&this.playing&&(console.log("stop video"),this.StopButtonEnabled(!1),this.PlayButtonEnabled(!0),t&&(pc.platform.mobile&&!e.xr.active||this.playButton&&(this.playButton.model.material.emissive=this.playButton.script.hoverChangeColor.hoverColor,this.playButton.model.material.update())),setTimeout((function(){i.playing=!1,i.video.muted=!0,i.video.load(),e.fire("pulse:start"),e.fire("music:fadeIn","Music")}),250))},MediaPlayer.prototype.mute=function(t){var e=this.app,i=this;this.video.muted||(t&&(pc.platform.mobile&&!e.xr.active||this.playButton&&(this.playButton.model.material.emissive=this.playButton.script.hoverChangeColor.hoverColor,this.playButton.model.material.update())),this.StopButtonEnabled(!1),this.PlayButtonEnabled(!0),setTimeout((function(){i.video.muted=!0,e.fire("pulse:start"),e.fire("music:fadeIn","Music")}),250))},MediaPlayer.prototype.update=function(t){this.playing&&this.frameCount++%this.updateEvery==0&&this.texture.upload()};var FadingObjectIn=pc.createScript("FadeObjectIn");FadingObjectIn.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingObjectIn.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingObjectIn.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(){this.fadeIn()}),this)},FadingObjectIn.prototype.fadeIn=function(){var t=this;if(!this.isRunning){this.isRunning=!0;var n={alpha:0},i=this.entity.model.meshInstances,e=this.entity.tween(n).to({alpha:1},this.duration,pc.SineInOut);e.on("update",(function(){for(var t=0;t<i.length;++t)i[t].setParameter("material_opacity",n.alpha)})).on("complete",(function(){t.isRunning=!1})),e.start()}};var FadingObjectOut=pc.createScript("FadeObjectOut");FadingObjectOut.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingObjectOut.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingObjectOut.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(){this.fadeOut()}),this)},FadingObjectOut.prototype.fadeOut=function(){var t=this;if(!this.isRunning){this.isRunning=!0;var n={alpha:1},i=this.entity.model.meshInstances,e=this.entity.tween(n).to({alpha:0},this.duration,pc.SineInOut);e.on("update",(function(){for(var t=0;t<i.length;++t)i[t].setParameter("material_opacity",n.alpha)})).on("complete",(function(){t.isRunning=!1})),e.start()}};var AudioCurve=pc.createScript("audioCurve");AudioCurve.attributes.add("volumeCurve",{type:"curve",title:"Volume Curve"}),AudioCurve.attributes.add("sound",{type:"string"}),AudioCurve.prototype.initialize=function(){this.slot=this.entity.sound.slot(this.sound);var t=this.slot.asset;this.duration=this.app.assets.get(t).resource.duration},AudioCurve.prototype.update=function(t){for(var e=0;e<this.slot.instances.length;++e){var i=this.slot.instances[e];i.volume=this.volumeCurve.value(i.currentTime/this.duration)}};var FadingSoundIn=pc.createScript("FadeSoundIn");FadingSoundIn.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingSoundIn.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingSoundIn.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(t){var n=this.entity.sound.slot(t);this.currentVolume=n.volume,this.fadeIn(t)}),this)},FadingSoundIn.prototype.fadeIn=function(t){var n=this,i=this.entity.sound.slot(t);if(!this.isRunning&&i&&i.instances[0]&&0===i.instances[0].volume){this.isRunning=!0;var e={volume:0},u=this.entity.tween(e).to({volume:this.currentVolume},this.duration,pc.SineInOut);u.on("update",(function(){for(var t=0;t<i.instances.length;++t){i.instances[t].volume=e.volume}})).on("complete",(function(){n.isRunning=!1})),u.start()}};var FadingSoundOut=pc.createScript("FadeSoundOut");FadingSoundOut.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingSoundOut.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingSoundOut.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(t){var n=this.entity.sound.slot(t);this.currentVolume=n.volume,this.fadeOut(t)}),this)},FadingSoundOut.prototype.fadeOut=function(t){var n=this,i=this.entity.sound.slot(t);if(!this.isRunning&&i&&i.instances[0]&&0!==i.instances[0].volume){this.isRunning=!0;var e={volume:this.currentVolume},u=this.entity.tween(e).to({volume:0},this.duration,pc.SineInOut);u.on("update",(function(){for(var t=0;t<i.instances.length;++t){i.instances[t].volume=e.volume}})).on("complete",(function(){n.isRunning=!1})),u.start()}};var InteractionManager=pc.createScript("interactionManager");InteractionManager.prototype.initialize=function(){var t=this.app;t.on("interactMgr:hoveroff",(function(a){a&&(a.tags.has("interactable")||a.tags.has("UI")?this.hoverOff(a):a.tags.has("bottle")&&t.fire("lookCamera:focusModeOff"))}),this),t.on("interactMgr:hoveron",(function(a){a&&(a.tags.has("interactable")||a.tags.has("UI")?this.hoverOn(a):a.tags.has("bottle")&&t.fire("lookCamera:focusModeOn"))}),this),t.on("interactMgr:activate",(function(a){a&&(a.tags.has("clickable")?t.fire("game:activate",a):a.tags.has("UI_PlayBtn")?(t.fire("infoboard:close"),t.fire("media-player:playBtnClick",!0,!1)):a.tags.has("UI_StopBtn")?t.fire("media-player:stopBtnClick",!0):a.tags.has("UI_MuteBtn")?t.fire("media-player:muteVideo",!0):a.tags.has("UI_ShowBottleBtn")?t.fire("bottlemgr:showBtnClick",!0):a.tags.has("UI_HideBottleBtn")?t.fire("bottlemgr:hideBtnClick",!0):a.tags.has("UI_LeftBtn")?t.fire("lookCamera:rotateleft"):a.tags.has("UI_RightBtn")&&t.fire("lookCamera:rotateright"))}),this)},InteractionManager.prototype.hoverOn=function(t){t.script.hoverChangeColor.hoverOn()},InteractionManager.prototype.hoverOff=function(t){t.script.hoverChangeColor.hoverOff()};var SphereIn=pc.createScript("sphereIn");SphereIn.attributes.add("event",{type:"string"}),SphereIn.attributes.add("duration",{type:"number",default:1}),SphereIn.attributes.add("distance",{type:"number",default:10}),SphereIn.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.event,(function(t){this.animate(t)}),this)},SphereIn.prototype.animate=function(t){var i=this;if(!this.isRunning){this.isRunning=!0,this.finalDest=new pc.Vec3,this.finalDest.x=this.entity.getLocalPosition().x+t.x*this.distance,this.finalDest.y=this.entity.getLocalPosition().y+t.y*this.distance,this.finalDest.z=this.entity.getLocalPosition().z+t.z*this.distance;var n=this.entity.tween(this.entity.getLocalPosition()).to(this.finalDest,this.duration,pc.SineIn);n.on("complete",(function(){i.isRunning=!1})),n.start()}};var SphereOut=pc.createScript("sphereOut");SphereOut.attributes.add("event",{type:"string"}),SphereOut.attributes.add("duration",{type:"number",default:1}),SphereOut.attributes.add("distance",{type:"number",default:10}),SphereOut.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.event,(function(t){this.animate(t)}),this)},SphereOut.prototype.animate=function(t){var i=this;if(!this.isRunning){this.isRunning=!0;var e=this.entity.getLocalPosition().clone();this.entity.setLocalPosition(e.x+t.x*i.distance,e.y+t.y*i.distance,e.z+t.z*i.distance);var n=this.entity.tween(this.entity.getLocalPosition()).to({x:e.x,y:e.y,z:e.z},this.duration,pc.SineOut);n.on("complete",(function(){i.isRunning=!1})),n.start()}};var BottleManager=pc.createScript("bottleManager");BottleManager.attributes.add("playButton",{type:"entity"}),BottleManager.attributes.add("stopButton",{type:"entity"}),BottleManager.attributes.add("cameraEntity",{type:"entity"}),BottleManager.attributes.add("bottleItem",{type:"entity"}),BottleManager.attributes.add("distanceRatio",{type:"number",default:.75}),BottleManager.attributes.add("leftButton",{type:"entity"}),BottleManager.attributes.add("rightButton",{type:"entity"}),BottleManager.attributes.add("tuto",{type:"entity"}),BottleManager.attributes.add("timeTutoIsShown",{type:"number",default:3e3}),BottleManager.prototype.initialize=function(){var t=this.app;this.tutoAlreadyShown=!1,this.bottleStartingPos=this.bottleItem.getLocalPosition().clone(),t.on("bottlemgr:showBtnClick",(function(t){this.showBottle(t)}),this),t.on("bottlemgr:hideBtnClick",(function(t){this.hideBottle(t)}),this),t.xr.on("start",(function(){this.leftButton.enabled=!0,this.rightButton.enabled=!0}),this),t.xr.on("end",(function(){this.leftButton.enabled=!1,this.rightButton.enabled=!1}),this),t.fire("pulse:start")},BottleManager.prototype.showBottle=function(t){var e=this.app;this.bottleItem.enabled=!0,this.ShowBottleButtonEnabled(!1),this.HideBottleButtonEnabled(!0),this.tutoAlreadyShown||e.xr.active||(this.tuto.enabled=!0,this.tutoAlreadyShown=!0,setTimeout((function(){e.fire("tuto2:fadeout")}),this.timeTutoIsShown)),t&&(pc.platform.mobile&&!e.xr.active||(this.stopButton.model.material.emissive=this.stopButton.script.hoverChangeColor.hoverColor,this.stopButton.model.material.update())),e.xr.active&&(this.stopButton.model.material.emissive=this.stopButton.script.hoverChangeColor.hoverColor,this.stopButton.model.material.update()),e.fire("pulse:start");this.cameraEntity.getPosition();var o=new pc.Vec3;o.sub2(this.cameraEntity.getPosition(),this.bottleStartingPos);var i=o.length();o.normalize(),i*=this.distanceRatio;var a=new pc.Vec3;o.x*=i,o.y*=i,o.z*=i,a.add2(this.bottleStartingPos,o),a.y+=.1,a.x-=.05,e.fire("bottlein:animate",a)},BottleManager.prototype.hideBottle=function(t){var e=this.app,o=this;this.HideBottleButtonEnabled(!1),this.ShowBottleButtonEnabled(!0),t&&(pc.platform.mobile&&!e.xr.active||(this.playButton.model.material.emissive=this.playButton.script.hoverChangeColor.hoverColor,this.playButton.model.material.update())),e.fire("pulse:start"),e.fire("bottleout:animate",this.bottleStartingPos),setTimeout((function(){o.bottleItem.enabled=!1}),500)},BottleManager.prototype.ShowBottleButtonEnabled=function(t){this.playButton.enabled=t},BottleManager.prototype.HideBottleButtonEnabled=function(t){this.stopButton.enabled=t};var BottleIn=pc.createScript("bottleIn");BottleIn.attributes.add("event",{type:"string"}),BottleIn.attributes.add("duration",{type:"number",default:1}),BottleIn.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.event,(function(t){this.animate(t)}),this)},BottleIn.prototype.animate=function(t){var n=this;if(!this.isRunning){this.isRunning=!0;this.entity.getLocalPosition().clone();var i=this.entity.tween(this.entity.getLocalPosition()).to(t,this.duration,pc.SineIn);i.on("complete",(function(){n.isRunning=!1})),i.start()}};var BottleOut=pc.createScript("bottleOut");BottleOut.attributes.add("event",{type:"string"}),BottleOut.attributes.add("duration",{type:"number",default:1}),BottleOut.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.event,(function(t){this.animate(t)}),this)},BottleOut.prototype.animate=function(t){var i=this;if(!this.isRunning){this.isRunning=!0;this.entity.getLocalPosition().clone();var n=this.entity.tween(this.entity.getLocalPosition()).to(t,this.duration,pc.SineIn);n.on("complete",(function(){i.isRunning=!1})),n.start()}};pc.script.createLoadingScreen((function(t){var showButton=function(){var t=document.getElementById("myId"),e=document.createElement("BUTTON");e.id="myButton",e.innerHTML="Enter",e.style.width="80%",e.style.height="5vh",e.style.background="white",e.style.color="black",e.style.fontSize="16px",t.appendChild(e),console.log(t),e.onclick=function(t){var e;(e=document.getElementById("splash__wrapper")).parentElement.removeChild(e)}};!function(){var t="https://d148xrjotn7dtb.cloudfront.net/Gotham-Bold.otf",e=t.lastIndexOf("/"),n=t.lastIndexOf("."),s=t.substr(e+1,n-e-1);console.log(s);var a=["html {","    -webkit-text-size-adjust: none;","    touch-action: pan-y;","}","body {","    background-color: #283538;","}","#splash__wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #000000;","    display: flex;","    align-items: center;","    text-align: center;","    justify-content: center;","}","#splash__wrapper img {","    max-width: 100%;","}",".splash__inner {","    width: 100%;","    max-width: 90vh;","    margin: 0 20px;","}",".splash__inner2 {","    padding-top: 65%;","    position: relative;","}",".splash__inner3 {","    position: absolute;","    top: 0;","    right: 0;","    bottom: 0;","    left: 0;","    display: flex;","    justify-content: center;","    align-items: center;","}",".splash__col-l {","    text-align: left;","}",".splash__col-r {","    margin-left: 6%;","    text-align: left;","}",".splash__progress-bar-container {","    margin: 0.5% 0 15px 6px;","    height: 7px;","    width: 100%;","    margin-left: 1vw;","    max-width: 240px;","    background-color: #1d292c;","}",".splash__progress-bar {","    width: 0%;","    height: 100%;","    background-color: #FFFFFF;","}","@media (max-width: 900px) {","    .splash__progress-bar-container {","        margin: 0.5% 0 15px 4%;","        height: 5px;","        width: calc(100% - 7px);","    }","   .splash__inner {","   }","   .splash__img-text{","       margin-left: 2px;","   }","}","#myButton {","    font-family: "+s+";","    font-weight: Bold;","    border-radius: 4px;","    margin-left: 15px;","}","@media screen and (min-width: 320px) {","#myButton {","font-size: calc(16px + 6 * ((100vw - 320px) / 680));","}","}","@media screen and (min-width: 1000px) {","#myButton {","font-size: 22px;"," }","@font-face {","    font-family: "+s+";","    src: url("+t+");","}"].join("\n"),i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),document.head.appendChild(i)}(),function(){window.addEventListener("wheel",(t=>{t.preventDefault()}),{passive:!1});var t=document.createElement("div");t.id="splash__wrapper",t.innerHTML='        <div class="splash__inner">            <div class="splash__inner2">                <div class="splash__inner3">                    <div class="splash__col-r" id="myId">                        <img class="splash__img-diesel" src="https://d148xrjotn7dtb.cloudfront.net/titleSplash.png" alt="" />                        <div class="splash__progress-bar-container">                            <div class="splash__progress-bar" id="splash__progress-bar">                            </div>                        </div>                        <img class="splash__img-text" src="https://d148xrjotn7dtb.cloudfront.net/texteSplash.png" alt="" />                    </div>                </div>            </div>        </div>',document.body.appendChild(t)}(),t.on("preload:end",(function(){t.off("preload:progress")})),t.on("initialize",(function(){t.fire("customload:start")})),t.on("customload:end",(function(){t.off("customload:progress"),showButton()})),t.on("preload:progress",(function(t){var e=document.getElementById("splash__progress-bar");e&&(t=Math.min(1,Math.max(0,t)),e.style.width=100*t+"%")}))}));var Billboard=pc.createScript("billboard");Billboard.attributes.add("camera",{type:"entity",title:"Camera"}),Billboard.prototype.initialize=function(){},Billboard.prototype.update=function(t){this.entity.setEulerAngles(0,this.camera.getEulerAngles().y,0)};var ScreensMgr=pc.createScript("screensMgr");ScreensMgr.attributes.add("startingEvent",{type:"string",title:"Event Name"}),ScreensMgr.attributes.add("Tv",{type:"entity"}),ScreensMgr.attributes.add("Pad",{type:"entity"}),ScreensMgr.attributes.add("TvPos",{type:"vec3",default:[0,0,0]}),ScreensMgr.attributes.add("TvRot",{type:"vec3",default:[0,0,0]}),ScreensMgr.attributes.add("TvScale",{type:"vec3",default:[1,1,1]}),ScreensMgr.attributes.add("PadPos",{type:"vec3",default:[0,0,0]}),ScreensMgr.attributes.add("PadRot",{type:"vec3",default:[0,0,0]}),ScreensMgr.attributes.add("PadScale",{type:"vec3",default:[1,1,1]}),ScreensMgr.prototype.initialize=function(){this.app.on(this.startingEvent,(function(){this.Tv.setPosition(this.TvPos),this.Tv.setLocalEulerAngles(this.TvRot),this.Tv.setLocalScale(this.TvScale),this.Pad.setPosition(this.PadPos),this.Pad.setLocalEulerAngles(this.PadRot),this.Pad.setLocalScale(this.PadScale)}),this)};var HoverChangeColor=pc.createScript("hoverChangeColor");HoverChangeColor.attributes.add("hoverColor",{type:"rgb",default:[0,0,1]}),HoverChangeColor.attributes.add("duration",{type:"number",default:.1}),HoverChangeColor.prototype.initialize=function(){this.originalColor=this.entity.model.material.emissive.clone(),this.tweenHoverOnDone=!0,this.tweenHoverOffDone=!0},HoverChangeColor.prototype.hoverOn=function(){this.app;var e=this;if(this.tweenHoverOnDone){this.tweenHoverOnDone=!0;var o=this.entity.model.material,t=this.originalColor.clone(),i=this.entity.tween(t).to(e.hoverColor,this.duration,pc.Linear);i.on("update",(function(){o.emissive=t,o.update()})),i.on("complete",(function(){o.emissive=e.hoverColor,o.update(),e.tweenHoverOnDone=!0})),i.start()}},HoverChangeColor.prototype.hoverOff=function(){this.app;var e=this;if(this.tweenHoverOffDone){this.tweenHoverOffDone=!0;var o=this.entity.model.material,t=o.emissive.clone(),i=this.entity.tween(t).to(e.originalColor,this.duration,pc.Linear);i.on("update",(function(){o.emissive=t,o.update()})),i.on("complete",(function(){o.emissive=e.originalColor,o.update(),e.tweenHoverOffDone=!0})),i.start()}};var LaunchUrl=pc.createScript("launchUrl");LaunchUrl.attributes.add("popupWidth",{type:"number",default:640}),LaunchUrl.attributes.add("popupHeight",{type:"number",default:300}),LaunchUrl.attributes.add("url",{type:"string"}),LaunchUrl.attributes.add("tag",{type:"string"}),LaunchUrl.attributes.add("tagMat",{type:"string"}),LaunchUrl.attributes.add("isVideo",{type:"boolean",default:!1}),LaunchUrl.attributes.add("skipIntermWindow",{type:"boolean",default:!1}),LaunchUrl.prototype.initialize=function(){},LaunchUrl.prototype.launch=function(){if(pc.platform.desktop&&!this.app.xr.active)if(this.isVideo)this.app.fire("infoboard:playVideo",this.url);else{var t=screen.width/2-this.popupWidth/2,i=screen.height/2-this.popupHeight/2;window.open(this.url,"popup","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+this.popupWidth+",height="+this.popupHeight+",top="+i+", left="+t)}else if(this.isVideo)this.app.fire("infoboard:playVideo",this.url);else{if(this.skipIntermWindow){var e=screen.width/2-this.popupWidth/2,o=screen.height/2-this.popupHeight/2;return void window.open(this.url,"popup","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+this.popupWidth+",height="+this.popupHeight+",top="+o+", left="+e)}var r=this.app,a=this,s=r.assets.findByTag(this.tagMat);if(0===s.lenght)return;var p=s[0],n=r.assets.findByTag(this.tag);if(0===n.lenght)return;var h=n[0];h.ready((function(){p.ready((function(){p.resource.emissiveMap=h.resource,p.resource.update(),r.fire("infoboard:weblink",a.url)})),r.assets.load(p)})),r.assets.load(h)}};var FadingElementIn=pc.createScript("FadeElementIn");FadingElementIn.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingElementIn.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingElementIn.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(){this.fadeIn()}),this)},FadingElementIn.prototype.fadeIn=function(){var t=this;if(!this.isRunning){this.isRunning=!0;var n={opacity:0},i=this.entity.tween(n).to({opacity:1},this.duration,pc.SineInOut);i.on("update",(function(){t.entity.element.material.opacity=n.opacity,t.entity.element.material.update()})).on("complete",(function(){t.isRunning=!1})),i.start()}};var FadingElementOut=pc.createScript("FadeElementOut");FadingElementOut.attributes.add("duration",{type:"number",default:2,title:"Duration (Secs)"}),FadingElementOut.attributes.add("startingEvent",{title:"Event",type:"string"}),FadingElementOut.prototype.initialize=function(){this.isRunning=!1,this.app.on(this.startingEvent,(function(){this.fadeOut()}),this)},FadingElementOut.prototype.fadeOut=function(){var t=this;if(!this.isRunning){this.isRunning=!0;var n={opacity:1},i=this.entity.tween(n).to({opacity:0},this.duration,pc.SineInOut);i.on("update",(function(){t.entity.element.material.opacity=n.opacity,t.entity.element.material.update()})).on("complete",(function(){t.isRunning=!1})),i.start()}};var InfoBoardMgr=pc.createScript("infoBoardMgr");InfoBoardMgr.attributes.add("VideoBoard",{type:"entity"}),InfoBoardMgr.attributes.add("WebBoard",{type:"entity"}),InfoBoardMgr.attributes.add("CloseBtn",{type:"entity"}),InfoBoardMgr.attributes.add("GoToBtn",{type:"entity"}),InfoBoardMgr.attributes.add("WebCloseBtn",{type:"entity"}),InfoBoardMgr.attributes.add("WebGoToBtn",{type:"entity"}),InfoBoardMgr.attributes.add("CameraNode",{type:"entity"}),InfoBoardMgr.attributes.add("WorldNode",{type:"entity"}),InfoBoardMgr.attributes.add("popupWidth",{type:"number",default:600}),InfoBoardMgr.attributes.add("popupHeight",{type:"number",default:600}),InfoBoardMgr.prototype.initialize=function(){this.VideoBoard.enabled=!1,this.WebBoard.enabled=!1,this.CloseBtn.enabled=!1,this.GoToBtn.enabled=!1,this.WebCloseBtn.enabled=!1,this.WebGoToBtn.enabled=!1,this.buttonUrl="",this.app.xr.on("end",(function(){this.app.fire("infoboard:close"),this.entity.reparent(this.CameraNode)}),this),this.app.xr.on("start",(function(){this.app.fire("infoboard:close")}),this),this.app.on("infoboard:playVideo",(function(t){this.app.fire("music:fadeOut","Music"),this.buttonUrl="",this.VideoBoard.enabled=!0,this.WebBoard.enabled=!1,this.CloseBtn.enabled=!0,this.GoToBtn.enabled=!1,this.WebCloseBtn.enabled=!1,this.WebGoToBtn.enabled=!1,this.VideoBoard.script.mediaPlayer.initVideo(t)}),this),this.app.on("infoboard:weblink",(function(t){this.app.fire("iframe:stopVideo"),this.app.fire("music:fadeIn","Music"),this.buttonUrl=t,this.VideoBoard.enabled=!1,this.WebBoard.enabled=!0,this.CloseBtn.enabled=!1,this.GoToBtn.enabled=!1,this.WebCloseBtn.enabled=!0,this.app.xr.active||(this.WebGoToBtn.enabled=!0)}),this),this.app.on("infoboard:close",(function(){this.app.fire("music:fadeIn","Music"),this.buttonUrl="",this.VideoBoard.enabled=!1,this.WebBoard.enabled=!1,this.CloseBtn.enabled=!1,this.GoToBtn.enabled=!1,this.WebCloseBtn.enabled=!1,this.WebGoToBtn.enabled=!1,this.VideoBoard.script.mediaPlayer.stopVideo()}),this),this.app.on("infoboard:openlink",(function(){this.buttonUrl&&(pc.platform.mobile?window.open(this.buttonUrl):window.open(this.buttonUrl,"popup","width="+this.popupWidth+",height="+this.popupHeight))}),this)};var ReparentBoard=pc.createScript("reparentBoard");ReparentBoard.attributes.add("board",{type:"entity"}),ReparentBoard.prototype.initialize=function(){this.app.xr.on("start",(function(){this.board.reparent(this.entity)}),this),this.app.on("reparentboard:update",(function(){this.app.xr.active&&this.entity.enabled&&this.board.reparent(this.entity)}),this),this.app.xr.active&&this.board.reparent(this.entity)};var DynamicLoading=pc.createScript("dynamicloading");DynamicLoading.prototype.initialize=function(){var a=this.app,t=this;this.total=0,a.on("customload:start",(function(){t.startCustomLoading()}))},DynamicLoading.prototype.startCustomLoading=function(){pc.platform.desktop?(this.loadImageEm("genMat","general8K"),this.loadImageEm("tattooMat","tattoo8K"),this.loadImageEm("loungeMat","lounge8K"),this.loadImageEm("trainingMat","training8K"),this.loadImageDiff("tutoMat","tutoDesktop")):(this.loadImageEm("genMat","general2K"),this.loadImageEm("tattooMat","tattoo2K"),this.loadImageEm("loungeMat","lounge2K"),this.loadImageEm("trainingMat","training2K"),this.loadImageDiff("tutoMat","tutoMobile"))},DynamicLoading.prototype.onAssetsLoaded=function(a,t){var o=this.app;this.total+=a,5===this.total&&o.fire("customload:end")},DynamicLoading.prototype.loadImageEm=function(a,t){var o=this.app,e=this,s=o.assets.findByTag(a)[0],i=o.assets.findByTag(t)[0];i.ready((function(){s.ready((function(){s.resource.emissiveMap=i.resource,s.resource.update(),e.onAssetsLoaded(1,t+" Loaded!")})),o.assets.load(s)})),o.assets.load(i)},DynamicLoading.prototype.loadImageDiff=function(a,t){var o=this.app,e=this,s=o.assets.findByTag(a)[0],i=o.assets.findByTag(t)[0];i.ready((function(){s.ready((function(){s.resource.diffuseMap=i.resource,s.resource.opacityMap=i.resource,s.resource.update(),e.onAssetsLoaded(1,t+" Loaded!")})),o.assets.load(s)})),o.assets.load(i)};var CameraAspect=pc.createScript("cameraAspect");CameraAspect.attributes.add("PortraitModeTrigger",{type:"number",default:1.125}),CameraAspect.prototype.initialize=function(){},CameraAspect.prototype.postInitialize=function(){var t=this.app;this.isLandscape=!0;var a=this.app.graphicsDevice.canvas;this.currentAspectRatio=a.width/a.height,this.currentAspectRatio<=this.PortraitModeTrigger&&(this.isLandscape=!1,t.fire("game:portrait"))},CameraAspect.prototype.update=function(t){var a=this.app,i=this.app.graphicsDevice.canvas,e=i.width/i.height;e!==this.currentAspectRatio&&(e<=this.PortraitModeTrigger&&this.isLandscape?(this.isLandscape=!1,a.fire("game:portrait")):e>this.PortraitModeTrigger&&!this.isLandscape&&(this.isLandscape=!0,a.fire("game:landscape")),this.currentAspectRatio=e)};

//# sourceMappingURL=__game-scripts.js.map